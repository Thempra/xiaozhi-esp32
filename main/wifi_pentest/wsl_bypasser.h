// Copyright 2025 XiaoZhi ESP32 Project
// WSL (Wi-Fi Stack Libraries) Bypasser
//
// This component bypasses ESP32 WiFi stack sanity checks to allow
// injection of raw 802.11 management frames (deauth, beacon, etc.)
//
// Based on: https://github.com/risinek/esp32-wifi-penetration-tool

#pragma once

#include <stdint.h>

#ifdef __cplusplus
extern "C" {
#endif

/**
 * @brief Override function for ESP32 WiFi stack sanity check
 *
 * This function overrides the built-in ieee80211_raw_frame_sanity_check()
 * in the ESP-IDF WiFi libraries at link time, allowing transmission of
 * management frames that would normally be blocked.
 *
 * IMPORTANT: This function MUST be linked into the final binary for
 * frame injection to work. The linker will replace the WiFi stack's
 * version with this one.
 *
 * @return Always returns 0 (pass sanity check)
 */
int ieee80211_raw_frame_sanity_check(int32_t arg, int32_t arg2, int32_t arg3);

/**
 * @brief Log initialization of WSL bypasser
 *
 * Call this to confirm the bypasser is active.
 * This is a verification function only - the actual bypass happens at link time.
 */
void wsl_bypasser_init(void);

#ifdef __cplusplus
}
#endif
